<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Rogdham">
  <link rel="canonical" href="https://bigxml.rogdham.net/faq/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>FAQ - BigXML</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "FAQ";
    var mkdocs_page_input_path = "faq.md";
    var mkdocs_page_url = "/faq/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> BigXML</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User guide</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../quickstart/">Quickstart</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../recipes/">Recipes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../encodings/">Encodings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../namespaces/">Namespaces</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">FAQ</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#parse-file-binary">What does opening a file in binary mode means?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#parse-str">How can I parse a string?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exnodes-out-of-order-exception">I keep getting the following exception: Tried to access a node out of order</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#i-have-an-other-issue-or-a-feature-request">I have an other issue, or a feature request</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../parser/">Parser</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../streams/">Streams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../handlers/">Handlers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../decorators/">Decorators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../nodes/">Nodes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">External Links</span></p>
                <ul>
                    <li class="toctree-l1"><a class="" href="https://github.com/rogdham/bigxml/blob/master/CHANGELOG.md">Changelog</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/rogdham/bigxml/issues">Issue tracker</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://github.com/rogdham/bigxml">BigXML @ GitHub</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://pypi.org/project/bigxml">BigXML @ PyPI</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">BigXML</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>User guide &raquo;</li>
        
      
    
    <li>FAQ</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/rogdham/bigxml/edit/master/docs/faq.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="frequently-asked-questions">Frequently Asked Questions</h1>
<h2 id="parse-file-binary">What does opening a file in binary mode means?</h2>
<p>By default, when you call <code>open("filename.xml")</code>, the file is open in text mode. In this
mode, the content of the file is returned as a string: the bytes are decoded on the fly.</p>
<p>However, <em>BigXML</em> needs <code>bytes</code>-oriented <a href="../streams/">streams</a>, so you need to open the
file in binary mode by explicitly specifying it with an extra parameter:
<code>open("filename.xml", "rb")</code>.</p>
<pre class="codehilite"><code class="language-xml">&lt;root&gt;Hello, world!&lt;/root&gt;
</code></pre>

<!---->

<pre class="codehilite"><code class="language-python">&gt;&gt;&gt; @xml_handle_element(&quot;root&quot;)
... def handler(node):
...     yield node.text

&gt;&gt;&gt; # BAD
&gt;&gt;&gt; with open(&quot;hello.xml&quot;) as f:
...    Parser(f).return_from(handler)
Traceback (most recent call last):
    ...
TypeError: Stream read method returned a str, not a bytes-like object.
           Open file objects in binary mode.

&gt;&gt;&gt; # GOOD
&gt;&gt;&gt; with open(&quot;hello.xml&quot;, &quot;rb&quot;) as f:
...    Parser(f).return_from(handler)
'Hello, world!'
</code></pre>

<h2 id="parse-str">How can I parse a string?</h2>
<p>Just convert <code>str</code> into <code>bytes</code> using <code>.encode</code> or <code>codecs.encode</code>:</p>
<pre class="codehilite"><code class="language-python">&gt;&gt;&gt; @xml_handle_element(&quot;root&quot;)
... def handler(node):
...     yield node.text
...
&gt;&gt;&gt; stream_str = &quot;&lt;root&gt;Hello, world!&lt;/root&gt;&quot;

&gt;&gt;&gt; # BAD
&gt;&gt;&gt; Parser(stream_str).return_from(handler)
Traceback (most recent call last):
    ...
TypeError: Invalid stream type: str.
           Convert it to a bytes-like object by encoding it.

&gt;&gt;&gt; # GOOD
&gt;&gt;&gt; Parser(stream_str.encode()).return_from(handler)
'Hello, world!'
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Read the error message!</p>
</div>
<h2 id="exnodes-out-of-order-exception">I keep getting the following exception: Tried to access a node out of order</h2>
<p>Each byte of the XML streams is only read once. An exception occurs when you try to
perform an action that would need to go backward in the streams. For more details,
<a href="..#philosophy">read the philosophy behind the design of <em>BigXML</em></a>.</p>
<p>Usually, the issue can be solved by following these principles:</p>
<ul>
<li>Consider that all children of a node must be processed in one pass;</li>
<li>You usually want to handle an <code>XMLElement</code> instance as soon as you receive it;</li>
<li>The <code>text</code> property of a <code>XMLElement</code> node needs to access all its children, so using
  it prevents you from calling <code>iter_from</code> and <code>return_from</code> on the same node.</li>
</ul>
<p>For example, consider the following piece of code:</p>
<pre class="codehilite"><code class="language-xml">&lt;user&gt;
    &lt;firstname&gt;Alice&lt;/firstname&gt;
    &lt;lastname&gt;Cooper&lt;/lastname&gt;
&lt;/user&gt;
</code></pre>

<!---->

<pre class="codehilite"><code class="language-python">&gt;&gt;&gt; @xml_handle_element(&quot;firstname&quot;)
... def handle_firstname(node):
...     yield node.text

&gt;&gt;&gt; @xml_handle_element(&quot;lastname&quot;)
... def handle_lastname(node):
...     yield node.text

&gt;&gt;&gt; @xml_handle_element(&quot;user&quot;)
... def handle_user(node):
...     firstname = node.return_from(handle_firstname)
...     lastname = node.return_from(handle_lastname)
...     yield f&quot;{firstname} {lastname}&quot;

&gt;&gt;&gt; with open(&quot;user.xml&quot;, &quot;rb&quot;) as f:
...    Parser(f).return_from(handle_user)
Traceback (most recent call last):
    ...
RuntimeError: Tried to access a node out of order
</code></pre>

<p>The issue occurred because the children of the <code>user</code> node are read twice:</p>
<ul>
<li>A first time to obtain a <code>firstname</code> child;</li>
<li>A second time to obtain a <code>lastname</code> child.</li>
</ul>
<p>Instead, we need to consider the <code>firstname</code> and <code>lastname</code> children at the same time:</p>
<pre class="codehilite"><code class="language-python">&gt;&gt;&gt; @xml_handle_element(&quot;user&quot;)
... def handle_user(node):
...     names = {}
...     for child_node in node.iter_from(&quot;firstname&quot;, &quot;lastname&quot;):
...         names[child_node.name] = child_node.text
...     yield f&quot;{names['firstname']} {names['lastname']}&quot;

&gt;&gt;&gt; with open(&quot;user.xml&quot;, &quot;rb&quot;) as f:
...    Parser(f).return_from(handle_user)
'Alice Cooper'
</code></pre>

<p>The code above is hardly readable; you probably want to use a
<a href="../handlers/#classes">class handler</a> instead:</p>
<pre class="codehilite"><code class="language-python">&gt;&gt;&gt; from dataclasses import dataclass

&gt;&gt;&gt; @xml_handle_element(&quot;user&quot;)
... @dataclass
... class User:
...     firstname: str = 'N/A'
...     lastname: str = 'N/A'
...
...     @xml_handle_element(&quot;firstname&quot;)
...     def handle_firstname(self, node):
...         self.firstname = node.text
...
...     @xml_handle_element(&quot;lastname&quot;)
...     def handle_lastname(self, node):
...         self.lastname = node.text
...
...     def xml_handler(self):
...         yield f&quot;{self.firstname} {self.lastname}&quot;

&gt;&gt;&gt; with open(&quot;user.xml&quot;, &quot;rb&quot;) as f:
...    Parser(f).return_from(User)
'Alice Cooper'
</code></pre>

<h2 id="i-have-an-other-issue-or-a-feature-request">I have an other issue, or a feature request</h2>
<p>By all means, <a href="https://github.com/rogdham/bigxml/issues">open an issue</a> on GitHub!</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../parser/" class="btn btn-neutral float-right" title="Parser">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../namespaces/" class="btn btn-neutral" title="Namespaces"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/rogdham/bigxml/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../namespaces/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../parser/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
